<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÄÄƒng nháº­p Quáº£n trá»‹ viÃªn</title>
    <style>
        body { font-family: Arial, sans-serif; background: #2c3e50; margin: 0; padding: 20px; height: 100vh; display: flex; justify-content: center; align-items: center; }
        .box { background: white; padding: 30px; border-radius: 10px; width: 300px; text-align: center; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        h2 { color: #2c3e50; margin-bottom: 20px; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #2980b9; }
        button:disabled { background: #95a5a6; cursor: not-allowed; }
        .error { color: red; margin-top: 10px; min-height: 20px; }
        .success { color: green; margin-top: 10px; min-height: 20px; }
    </style>
</head>
<body>
    <div class="box">
        <h2>ğŸ” ÄÄ‚NG NHáº¬P QUáº¢N TRá»Š</h2>
        <p style="color: #666; margin-bottom: 20px;">Vui lÃ²ng Ä‘Äƒng nháº­p Ä‘á»ƒ tiáº¿p tá»¥c</p>
        
        <input type="text" id="user" placeholder="TÃªn Ä‘Äƒng nháº­p" autocomplete="username">
        <input type="password" id="pass" placeholder="Máº­t kháº©u" autocomplete="current-password">
        
        <button id="loginBtn" onclick="login()">ÄÄ‚NG NHáº¬P</button>
        
        <div id="msg"></div>
        
        <p style="margin-top: 20px; font-size: 12px; color: #666;">
            <a href="../index.html" style="color: #3498db; text-decoration: none;">â† Quay láº¡i trang chá»§</a>
        </p>
    </div>

    <script>
        const API_URL = window.location.origin + '/api';
        
        // ===== LOGIN FUNCTION =====
        async function login() {
            const user = document.getElementById('user').value.trim();
            const pass = document.getElementById('pass').value;
            const msg = document.getElementById('msg');
            const loginBtn = document.getElementById('loginBtn');
            
            msg.textContent = '';
            msg.className = '';
            
            if (!user || !pass) {
                msg.textContent = 'Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin!';
                msg.className = 'error';
                return;
            }
            
            // Disable button during login
            loginBtn.disabled = true;
            loginBtn.textContent = 'Äang xá»­ lÃ½...';
            
            try {
                const response = await fetch(`${API_URL}/admin/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: user,
                        password: pass
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // LÆ°u token vÃ  thÃ´ng tin user
                    localStorage.setItem('adminToken', result.token);
                    localStorage.setItem('adminUser', JSON.stringify({
                        username: result.user.username,
                        name: result.user.name,
                        role: result.user.role || 'admin',
                        loginTime: new Date().toLocaleString('vi-VN')
                    }));
                    
                    msg.style.color = 'green';
                    msg.textContent = 'âœ“ ÄÄƒng nháº­p thÃ nh cÃ´ng! Äang chuyá»ƒn hÆ°á»›ng...';
                    msg.className = 'success';
                    
                    // Chuyá»ƒn Ä‘áº¿n dashboard sau 1 giÃ¢y
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                    
                } else {
                    msg.textContent = 'âœ— ' + (result.message || 'Sai tÃªn Ä‘Äƒng nháº­p hoáº·c máº­t kháº©u!');
                    msg.className = 'error';
                    document.getElementById('pass').value = '';
                    document.getElementById('pass').focus();
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'ÄÄ‚NG NHáº¬P';
                }
            } catch (error) {
                msg.textContent = 'âœ— Lá»—i káº¿t ná»‘i! Vui lÃ²ng thá»­ láº¡i sau.';
                msg.className = 'error';
                loginBtn.disabled = false;
                loginBtn.textContent = 'ÄÄ‚NG NHáº¬P';
            }
        }
        
        // Enter key support
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const loginBtn = document.getElementById('loginBtn');
                if (!loginBtn.disabled) {
                    login();
                }
            }
        });
        
        // Auto-focus on username input
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('user').focus();
        });
    </script>
</body>
</html>